<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <style>
    	.node circle {
		  fill: #228B22;
		}

		.node text {
		  font: 18px sans-serif;
		  font-weight: bold;
		}

		.node--internal circle {
		  fill: #6B8E23;
		}

		.node--internal text {
		  text-shadow: 0 1px 0 #fff, 0 -1px 0 #fff, 1px 0 0 #fff, -1px 0 0 #fff;
		}

		.link {
		  fill: none;
		  stroke: #8B4513;
		  stroke-opacity: 0.5;
		  stroke-width: 5px;
		}
    </style>
    <title>Created with Code by brittany2e</title>
  </head>

  <body>
   <div id="container">
      <div class="inner">
		<header>
          <h1>Created with Code</h1>
          <h2>By Brittany Tuohy</h2>
        </header>
        <section id="main_content">
			<svg width="960" height="500"></svg>
		</section>
		<p>Special thanks to Mike Bostock for the <a href="https://bl.ocks.org/mbostock/4063550">Radial Tidy Tree</a>.</p>
        <footer>
          This page was generated by <a href="https://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

      </div>
    </div>
  </body>
</html>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

var svg = d3.select("svg"),
    width = +svg.attr("width"),
    height = +svg.attr("height"),
    g = svg.append("g").attr("transform", "translate(" + (width / 2) + "," + (420) + ")");

var stratify = d3.stratify()
    .parentId(function(d) { return d.id.substring(0, d.id.lastIndexOf(".")); });

var tree = d3.tree()
    .size([2 * Math.PI, 500])
    .separation(function(a, b) { return (a.parent == b.parent ? 1 : 2) / a.depth; });

d3.csv("family.csv", function(error, data) {
  if (error) throw error;

  var root = tree(stratify(data));

  var link = g.selectAll(".link")
    .data(root.links())
    .enter().append("path")
      .attr("class", "link")
      .attr("d", d3.linkRadial()
          .angle(function(d) { return (d.x-Math.PI)/2.0; })
          .radius(function(d) { return d.y*.8; }));

  var node = g.selectAll(".node")
    .data(root.descendants())
    .enter().append("g")
      .attr("class", function(d) { return "node" + (d.children ? " node--internal" : " node--leaf"); })
      .attr("transform", function(d) { return "translate(" + radialPoint(d.x, d.y) + ")"; });

  node.append("circle")
      .attr("r", 9);

  node.append("text")
      .attr("dy", function(d) { return wordYOffset(root,d); })
      .attr("x", function(d) { return wordXOffset(root,d); })
      .attr("text-anchor", function(d) { return textAnchor(root, d) }) 
      .attr("transform", function(d) { return wordTransform(root, d); })
      .text(function(d) { return d.id.substring(d.id.lastIndexOf(".") + 1); });
});

function radialPoint(x, y) {
  var xp = (x-Math.PI)/2.0;
  var yp = y*0.8;
  return [(y = +yp) * Math.cos(xp -= Math.PI / 2), yp * Math.sin(xp)];
}

function wordTransform(root, d) {
    return "rotate(" + wordRotate(root, d) + ")";
}

function wordRotate(root, d) {
  return d === root
    ? 0 
    : (d.x < Math.PI 
	  	? d.x/2 
	  	: d.x/2 + Math.PI) 
	* 180 / Math.PI;
}

function textAnchor(root, d) {
	return d === root
	  ? "middle" 
	  : d.x >= Math.PI
	  ? "end"
	  : "start";
}

function wordYOffset(root, d) {
    return d === root 
      ? "1.3em" 
      : "0.4em"; 
}

function wordXOffset(root, d) {
    return d === root 
      ? 0 
      : d.x >= Math.PI
      ? -11
      : 11; 
}

</script>